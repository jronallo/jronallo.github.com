<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <link rel="canonical" href="http://ronallo.com/projects/rare-unique-digital/digital-collections-now/">
    <!-- FIXME: After DNS caches have been cleared it will be safe to put this redirect in place. -->
    <!-- <meta http-equiv="refresh" content="0;URL=http://ronallo.com/projects/rare-unique-digital/digital-collections-now/"> -->



    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Digital Collections Now! | Preliminary Inventory of Digital Collections by Jason Ronallo</title>

    <link href="/stylesheets/normalize-ef7858ef.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/all-7cf8716f.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/all-fe1cfabb.js" type="text/javascript"></script>
    <link href="/images/images/favicon.png" rel="icon" type="image/png" />
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,500,300' rel='stylesheet' type='text/css'>
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28548205-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  </head>

  <body class="projects projects_rare-unique-digital projects_rare-unique-digital_digital-collections-now projects_rare-unique-digital_digital-collections-now_index">
    <div id="page-wrap">
      <header id="masthead" class="site-header" role="banner">
  <a class="home-link" href="/" rel="home">
    <h1 class="site-title">Preliminary Inventory of Digital Collections</h1>
    <h2 class="site-description hidden-xs">Incomplete thoughts on digital libraries.</h2>
  </a>
</header>
      <nav class="navbar navbar-default" role="navigation">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <!-- <a class="navbar-brand" href="/">Preliminary Inventory of Digital Collections</a> -->
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse navbar-ex1-collapse">
    <ul class="nav navbar-nav">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Blog <b class="caret"></b></a>
        <ul class="dropdown-menu">
          <li><a href="/">Latest</a></li>
          <li><a href="/blog/tags">Tags</a></li>
          <li><a href="/blog/by_year">Calendar</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">CV <b class="caret"></b></a>
        <ul class="dropdown-menu">
          <li><a href="/projects">Projects</a></li>
          <li><a href="/presentations">Presentations</a></li>
          <li><a href="/writing">Writing</a></li>
          <li><a href="/experience">Experience</a></li>
          <li><a target="_blank" href="/cv">Print Full CV</a></li>
        </ul>
      </li>


      <li><a href="/about">About</a></li>
      <li><a href="/feed.xml"><i class="icon-rss-sign"></i> </a></li>
    </ul>

    <form class="navbar-form navbar-right" action="http://google.com/search" method="get" role="search">
      <div class="form-group">
        <input type="hidden" name="q" value="site:jronallo.github.io">
        <input class="search form-control" type="text" name="q" results="0" placeholder="Search...">
        </div>
    </form>

  </div><!-- /.navbar-collapse -->
</nav>
      <div class="container">
        <div id="redirect_message">
          <p class="large">This page has permanently moved to <a href="http://ronallo.com/projects/rare-unique-digital/digital-collections-now/">http://ronallo.com/projects/rare-unique-digital/digital-collections-now/</a></p>
          <p class="small">The stale content is below for a limited time for your convenience while DNS caches get expired.</p>
        </div>
          <a class="btn btn-default" href="/projects"><< back to projects</a>
  <article>
    <h1>Digital Collections Now!</h1>
    <p>A version of this was published on the <a href="http://acrl.ala.org/techconnect/?p=4454">ACRL TechConnect blog</a> on 2014-06-17. Scroll down to the bottom for some additional details on this project that were not included in that post.</p>

<p>When <a href="http://analytics.blogspot.com/2011/09/whats-happening-on-your-site-right-now.html">Google Analytics first turned on real-time reporting</a> it was mesmerizing. I could see what resources on the NCSU Libraries&#39; <a href="http://d.lib.ncsu.edu/collections">Rare and Unique Digital Collections site</a> were being viewed at the exact moment they were being viewed. Or rather I could view the URL for the resource being viewed. I happened to notice that there would sometimes be multiple people viewing the same resource at the same time. This gave me some hint that today someone&rsquo;s social share or forum post was getting a lot of click throughs right now or something happened in the news and we had an image of one of the people involved. I could then follow up and see examples of where we were being effective with search engine optimization.</p>

<p>The Rare &amp; Unique site has a lot of visual resources like <a href="http://d.lib.ncsu.edu/collections/catalog?f%5Bformat%5D%5B%5D=Still+image">photographs</a> and <a href="http://d.lib.ncsu.edu/collections/catalog?f%5Bformat%5D%5B%5D=Drawing&amp;f%5Btopic_facet%5D%5B%5D=Architecture">architectural drawings</a>. I wanted to see the actual images that were being viewed. The problem, though, was that Google Analytics does not have an easy way to click through from a URL to the resource on your site. I would have to retype the URL, copy and paste the part of the URL path, or do a search for the resource identifier. I just wanted to see the images now. (OK, this first use case was admittedly driven by the <a href="http://c2.com/cgi/wiki?LazinessImpatienceHubris">great virtue of laziness</a>.)</p>

<p>My first attempt at this was to create a page that would show the resources which had been viewed most frequently in the <a href="https://d.lib.ncsu.edu/collections/popular/today">past day</a> and <a href="https://d.lib.ncsu.edu/collections/popular/week">past week</a>. To enable this functionality, I added some custom logging that is saved to a database. Every view of every resource would just get a little tick mark that would be tallied up occasionally. These pages showing the popular resources of the moment are then regenerated every hour.</p>

<p>It was not a real-time view of activity, but it was easy to implement and it did answer a lot of questions for me about what was most popular. Some images are regularly in the group of the most-viewed images. I learned that people often visit the image of the <a href="https://d.lib.ncsu.edu/collections/catalog/ua015_010-004-bx0091-011-001">NC State men&rsquo;s basketball 1983 team roster</a> which went on to win the <a href="http://en.wikipedia.org/wiki/1983_NCAA_Men%27s_Division_I_Basketball_Tournament">NCAA tournament</a>. People also seem to really like the <a href="https://d.lib.ncsu.edu/collections/catalog/buch0036">indoor pool at the Biltmore estate</a>. </p>

<h3 id="toc_0">Really Real-Time</h3>

<p>Now that I had this logging in place I set about to make it really real-time. I wanted to see the actual images being viewed at that moment by a real user. I wanted to serve up a single page and have it be updated in real-time with what is being viewed. And this is where the persistent communication channel of WebSockets came in. WebSockets allows the server to immediately send these updates to the page to be displayed.  </p>

<p>People have told me they find this real-time view to be addictive. I found it to be useful. I have discovered images I never would have seen or even known how to search for before. At least for me this has been an effective form of serendipitous discovery. I also have a better sense of what different traffic volume actually feels like on good day. <a href="https://d.lib.ncsu.edu/collections/now">You too can see what folks are viewing in real-time now</a>. </p>

<iframe width="480" height="360" src="https://www.youtube.com/embed/7-CLzcPIdbI?rel=0" frameborder="0" allowfullscreen></iframe>

<h2 id="toc_1">Details</h2>

<p>The pieces required to make this all work are a Web application, a WebSocket server, and two browsers. Here is the flow through the application. A user requests a resource page. On the server the Web application sends a short message to the WebSocket server with the identifier of that resource. The WebSocket server broadcasts the message on a channel where all of the browser clients on the real-time page are listening for updates. When a browser client gets the message with the identifier, it makes a request back to the web application for the HTML snippet to display on the page. </p>

<p>This could be simplified some by sending the HTML snippet through the WebSocket server or not requiring everything to be routed through the web application. By doing things the way that I have, I am sending the shortest messages possible and allowing the WebSocket server to be rather dumb. The WebSocket server just needs to accept messages from particular applications or IP addresses and forward them along to every listening client. The security model becomes a lot simpler with the Web application, and not the WebSocket server, being responsible for validating that a message ought to be broadcast. The ability to reuse the WebSocket server in this configuration has also allowed me to reuse the same server for other projects.</p>

  </article>

      </div>
      <div id="footer-push"></div>
    </div><!-- end page-wrap -->
    <footer id="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-6">by Jason Ronallo</div>
      <div class="col-md-6 social">
        <a href="mailto:jronallo@gmail.com"><i class="icon-envelope"></i></a>
        <a href="https://plus.google.com/116830234234977722391?rel=author"><i class="icon-google-plus-sign"></i></a>
        <a href="http://twitter.com/ronallo"><i class="icon-twitter-sign"></i></a>
      </div>
    </div>
  </div>
</footer>
  </body>
</html>